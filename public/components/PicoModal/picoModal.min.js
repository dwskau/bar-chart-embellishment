window.picoModal=function(document){"use strict";var observable=function(){var callbacks=[];return{watch:function(callback){callbacks.push(callback)},trigger:function(){for(var i=0;i<callbacks.length;i++){setTimeout(callbacks[i],1)}}}};var make=function(parent){var elem=document.createElement("div");(parent||document.body).appendChild(elem);var iface={elem:elem,child:function(){return make(elem)},stylize:function(styles){styles=styles||{};if(typeof styles.opacity!=="undefined"){styles.filter="alpha(opacity="+styles.opacity*100+")"}for(var prop in styles){if(styles.hasOwnProperty(prop)){elem.style[prop]=styles[prop]}}return iface},clazz:function(clazz){elem.className+=clazz;return iface},html:function(content){elem.innerHTML=content;return iface},getWidth:function(){return elem.clientWidth},onClick:function(callback){if(elem.attachEvent){elem.attachEvent("onclick",callback)}else{elem.addEventListener("click",callback)}return iface},destroy:function(){document.body.removeChild(elem);return iface}};return iface};var overlay=function(styles){var clickCallbacks=observable();var elem=make().clazz("pico-overlay").stylize({display:"block",position:"fixed",top:"0px",left:"0px",height:"100%",width:"100%",opacity:.5,zIndex:1e4,background:"#000"}).stylize(styles).onClick(clickCallbacks.trigger);return{elem:elem.elem,destroy:elem.destroy,onClick:clickCallbacks.watch}};return function(options){if(typeof options==="string"){options={content:options,closeButton:true}}var shadow=overlay(options.overlayStyles);var closeCallbacks=observable();var elem=make().clazz("pico-content").stylize({display:"block",position:"fixed",zIndex:10001,left:"50%",top:"50px",backgroundColor:"white",padding:"20px",borderRadius:"5px"}).html(options.content);var width=options.width||elem.getWidth();elem.stylize({width:width+"px",margin:"0 0 0 "+(-(width/2)+"px")}).stylize(options.modalStyles);var close=function(){closeCallbacks.trigger();shadow.destroy();elem.destroy()};var shadowClose=options.shadowClose||true;if(shadowClose)shadow.onClick(close);var closeButton;if(options.closeButton){closeButton=elem.child().html("&#xD7;").clazz("pico-close").stylize({borderRadius:"2px",cursor:"pointer",height:"15px",width:"15px",position:"absolute",top:"5px",right:"5px",fontSize:"16px",textAlign:"center",lineHeight:"15px",background:"#CCC"}).stylize(options.closeStyles).onClick(close)}return{modalElem:elem.elem,closeElem:closeButton?closeButton.elem:null,overlayElem:shadow.elem,close:close,onClose:closeCallbacks.watch}}}(document);